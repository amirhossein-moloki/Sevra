# مستندات طراحی UI/UX و تحلیل سیستم سِورا (Sevra)

این مستند بر اساس بررسی موجودیت‌های دیتابیس و APIهای موجود تهیه شده است تا به عنوان مرجعی برای تیم توسعه فرانت‌اِند و بک‌اِند مورد استفاده قرار گیرد.

---

## ۱. پورتال عمومی مشتریان (Public Portal)
این بخش برای جذب مشتری و انجام رزرو آنلاین طراحی شده است.

| نام صفحه | اولویت | عملکردها (User Actions) | APIهای متصل | نوع پردازش بک‌اند |
| :--- | :--- | :--- | :--- | :--- |
| **صفحه اصلی (Landing)** | Critical | مشاهده معرفی آرایشگاه، گالری تصاویر، خدمات برتر و اطلاعات تماس. | `GET /public/salons/{slug}/pages/home` | نمایشی |
| **لیست خدمات و پرسنل** | Critical | مشاهده دسته‌بندی خدمات، قیمت‌ها و پروفایل عمومی آرایشگران. | `GET /public/salons/{slug}/services` <br> `GET /salons/{id}/staff` | نمایشی |
| **انتخاب زمان رزرو** | Critical | مشاهده تقویم کاری و انتخاب اسلات‌های زمانی خالی بر اساس آرایشگر. | `GET /public/salons/{slug}/availability/slots` | پردازش سنگین (الگوریتم تقاطع بازه‌ها) |
| **احراز هویت (OTP)** | Critical | ورود یا ثبت‌نام سریع با شماره موبایل جهت نهایی کردن رزرو. | `POST /auth/user/otp/request` <br> `POST /auth/user/otp/verify` | تولید کد و اعتبارسنجی |
| **تایید و پرداخت** | Critical | مشاهده پیش‌فاکتور، ثبت یادداشت و اتصال به درگاه پرداخت (در صورت نیاز). | `POST /public/salons/{slug}/bookings` | ایجاد موجودیت و صدور فاکتور |

---

## ۲. پنل مدیریت و پرسنل (Management Panel)
این پنل مختص مدیران، پذیرش و پرسنل جهت مدیریت عملیات روزانه است.

| نام صفحه | اولویت | عملکردها (User Actions) | APIهای متصل | نوع پردازش بک‌اند |
| :--- | :--- | :--- | :--- | :--- |
| **داشبورد (Analytics)** | Critical | مشاهده نمودار درآمد، آمار رزروهای امروز و عملکرد پرسنل. | `GET /salons/{id}/analytics/summary` <br> `/analytics/revenue-chart` | تجمیع داده‌ها (Aggregation) |
| **تقویم مدیریت رزروها** | Critical | مشاهده تمامی رزروها در تقویم، جابجایی زمان، تغییر وضعیت (تایید، لغو، اتمام). | `GET /salons/{id}/bookings` <br> `POST /bookings/{id}/confirm` <br> `POST /bookings/{id}/complete` | تغییر وضعیت (State Machine) |
| **مدیریت خدمات** | Critical | تعریف خدمات جدید، ویرایش قیمت و زمان، فعال/غیرفعال‌سازی. | `POST /salons/{id}/services` <br> `PATCH /salons/{id}/services/{sid}` | CRUD دیتابیس |
| **مدیریت پرسنل و شیفت** | Critical | افزودن آرایشگر، تخصیص خدمات به پرسنل و تعریف ساعات کاری (شیفت‌ها). | `POST /salons/{id}/staff` <br> `POST /staff/{uid}/shifts` | مدیریت دسترسی و تداخل زمان |
| **مدیریت مشتریان (CRM)** | Optional | مشاهده سوابق رزرو مشتری، ثبت یادداشت‌های خصوصی و مدیریت مشخصات. | `GET /salons/{id}/customers` | جستجو و فیلترینگ |
| **تنظیمات وب‌سایت و سئو** | Advanced | مدیریت اسلاگ (Slug)، تنظیمات سئو، آپلود لوگو و تصاویر گالری. | `PUT /salons/{id}/settings` <br> `POST /salons/{id}/media/upload` | پردازش تصویر و تنظیمات سیستمی |
| **امور مالی و کارمزد** | Advanced | مشاهده کارمزدهای سیستمی (Commissions) و ثبت پرداخت‌های تسویه حساب. | `GET /salons/{id}/commissions` <br> `POST /commissions/{id}/pay` | محاسبات مالی و مالیاتی |

---

## ۳. جریان کاربری (User Flow)

### الف) جریان رزرو توسط مشتری (Customer Booking Flow)
1. **Landing:** کاربر وارد سایت شده و خدمات را مشاهده می‌کند.
2. **Selection:** خدمت مورد نظر را انتخاب می‌کند.
3. **Availability:** سیستم بر اساس شیفت‌های پرسنل و رزروهای قبلی، زمان‌های خالی را نمایش می‌دهد.
4. **Auth:** کاربر با کد یک‌بار مصرف (OTP) وارد سیستم می‌شود.
5. **Confirmation:** رزرو ثبت شده و در وضعیت `CONFIRMED` یا `PENDING` قرار می‌گیرد.

### ب) جریان مدیریت رزرو (Management Flow)
1. **Notification:** آرایشگاه رزرو جدید را در تقویم مشاهده می‌کند.
2. **Action:** در صورت نیاز رزرو را تایید یا لغو می‌کند.
3. **Completion:** پس از ارائه خدمت، وضعیت به `DONE` تغییر یافته و فاکتور نهایی صادر می‌شود.

---

## ۴. دسته‌بندی اولویت‌ها (Priority Levels)

*   **Critical (حیاتی):** بخش‌هایی که برای کارکرد اصلی سیستم (رزرو و مدیریت آن) ضروری هستند. (MVP)
*   **Optional (اختیاری):** بخش‌هایی که تجربه کاربری را بهبود می‌دهند اما بدون آن‌ها هم سیستم کار می‌کند (مانند CRM مشتریان).
*   **Advanced (پیشرفته):** قابلیت‌هایی برای مدیریت کسب‌وکارهای بزرگ و تحلیل‌های مالی دقیق.

---

## ۵. نکات فنی برای پیاده‌سازی
*   **کشینگ (Caching):** نتایج اسلات‌های خالی (`availability`) می‌تواند برای مدت کوتاهی کش شود تا فشار روی دیتابیس کاهش یابد.
*   **همگام‌سازی (Sync):** تغییر وضعیت رزرو در پنل مدیریت باید بلافاصله (مثلاً از طریق WebSockets یا Polling) در تقویم به‌روزرسانی شود.
*   **تایم‌زون (Timezone):** تمامی زمان‌ها در بک‌اند به صورت UTC ذخیره می‌شوند اما باید بر اساس تایم‌زون تنظیم شده برای سالن (`settings.timeZone`) در فرانت نمایش داده شوند.
